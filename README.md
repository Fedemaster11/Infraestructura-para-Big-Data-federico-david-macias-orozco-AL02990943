Actividad 6.1 , 7.1 ,  9 – OpenWeather (Berlín) - Flight dtata frfankfurt  MYsql
Al02990943
Federico david Macias Orozco
Infraestructura para Big Data

En esta actividad generamos nuestra API key de OpenWeather, la guardamos de forma segura en la variable de entorno OPENWEATHER_API_KEY (sin subirla a GitHub) y desarrollamos un script en Python que consulta el endpoint de pronóstico 5 días / 3 horas para Berlín (/data/2.5/forecast) con units=metric y lang=es. El código obtiene el JSON, lo transforma a un DataFrame con columnas clave (time_utc, temperature, humidity, weather_status, wind_speed, rain_3h, snow_3h), normaliza tipos (fechas a datetime UTC y métricas numéricas), deduplica por time_utc conservando el registro más reciente y guarda los resultados en data/weather/berlin_forecast.csv. Finalmente verificamos la salida (mostrando las últimas filas) y publicamos el repositorio con el script y un .gitignore para no exponer credenciales ni datos crudos.


Actividad 7 Frankfurt
Para la actividad 7 recopilamos llegadas del aeropuerto de Fráncfort (FRA) usando AeroDataBox (RapidAPI). Consultamos el FIDS por rangos de 6 h (08:00–14:00 y 14:00–20:00 hora local) para cumplir el límite de la API (≤12 h), normalizamos el JSON con pandas.json_normalize, extraímos scheduled_arrival_utc y scheduled_arrival_frankfurt, junto con flight_number, aeropuerto de origen, aerolínea y modelo de aeronave; luego convertimos a datetime, filtramos filas sin hora y deduplicamos por (scheduled_arrival_utc, flight_number). Finalmente guardamos en data/flights/frankfurt_arrivals_tomorrow_divided.csv (UTF-8 con BOM para mostrar acentos correctamente en Excel).

Actividad 9 MySQL:
Esta actividad se centró en la implementación de la lógica ETL (Extracción, Transformación y Carga) para migrar los DataFrames recopilados en sesiones anteriores directamente a una infraestructura de base de datos MySQL. Inicialmente, se creó el esquema gans con sus cuatro tablas (city_pop, airport, weather_data y flight_arrival). Utilizando Python y la librería SQLAlchemy, se implementó la inserción de la información de la ciudad (Berlín, DE) y se adaptaron los scripts de recolección de OpenWeatherMap y AeroDataBox. El proceso culminó con la ejecución exitosa de los scripts, incluyendo la corrección crítica de la inconsistencia de columnas que requirió renombrar flight_number a flight_icao en el DataFrame antes de cargar los datos de vuelos, asegurando que tanto los datos climáticos como los 234 registros de llegadas de vuelos se insertaran correctamente en sus respectivas tablas. Finalmente, se verificó la migración completa mediante consultas SELECT * en MySQL Workbench.
